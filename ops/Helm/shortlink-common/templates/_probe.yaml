{{/* vim: set filetype=mustache: */}}

{{- define "shortlink-common.probe" }}
  {{- if .startupProbe }}
  startupProbe:
    httpGet:
      path: /healthz
      port: 9090
    initialDelaySeconds: 5
    periodSeconds: 5
    successThreshold: 1
    failureThreshold: 1
  {{- end }}

  {{- if .livenessProbe }}
  # -- define a liveness probe that checks every 5 seconds, starting after 5 seconds
  livenessProbe:
    httpGet:
      path: /live
      port: 9090
    initialDelaySeconds: 5
    periodSeconds: 5
    successThreshold: 1
    failureThreshold: 1
  {{- end }}

  {{- if .readinessProbe }}
  # -- define a readiness probe that checks every 5 seconds, starting after 5 seconds
  readinessProbe:
    httpGet:
      path: /ready
      port: 9090
    initialDelaySeconds: 5
    periodSeconds: 5
    successThreshold: 1
    failureThreshold: 30
  {{- end }}
{{- end }}
