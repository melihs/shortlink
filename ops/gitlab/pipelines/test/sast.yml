include:
  # https://gitlab.com/gitlab-org/gitlab/-/blob/master/lib/gitlab/ci/templates/Jobs/SAST.latest.gitlab-ci.yml
  - template: Jobs/SAST.latest.gitlab-ci.yml
  # https://gitlab.com/gitlab-org/gitlab-foss/-/blob/master/lib/gitlab/ci/templates/Jobs/SAST-IaC.latest.gitlab-ci.yml
  - template: Jobs/SAST-IaC.latest.gitlab-ci.yml

# SAST =================================================================================================================
# Read more about this feature here: https://docs.gitlab.com/ee/user/application_security/sast/
#
# Configure the scanning tool through the environment variables.
# List of the variables: https://gitlab.com/gitlab-org/security-products/sast#settings
# How to set: https://docs.gitlab.com/ee/ci/yaml/#variables

variables:
  SAST_EXPERIMENTAL_FEATURES: "true"

brakeman-sast:
  rules:
    - when: always

flawfinder-sast:
  rules:
    - when: always

kubesec-sast:
  variables:
    SECURE_LOG_LEVEL: "debug"
  rules:
    - when: always

mobsf-android-sast:
  rules:
    - when: always

mobsf-ios-sast:
  rules:
    - when: always

nodejs-scan-sast:
  rules:
    - when: always

phpcs-security-audit-sast:
  rules:
    - when: always

pmd-apex-sast:
  rules:
    - when: always

security-code-scan-sast:
  rules:
    - when: always

semgrep-sast:
  rules:
    - when: always

sobelow-sast:
  rules:
    - when: always

spotbugs-sast:
  rules:
    - when: always

kics-iac-sast:
  rules:
    - when: always

