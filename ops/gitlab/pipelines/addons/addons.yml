# Deploy ===============================================================================================================
prometheus-operator:
  stage: addons
  variables:
    RELEASE_NAME: prometheus-operator
    HELM_PATH: ops/Helm/addons/prometheus-operator
    HELM_NAMESPACE: prometheus-operator
    HELM_ARG: --set kube-prometheus-stack.alertmanager.config.global.slack_api_url=$SLACK_TOKEN
    ENVIRONMENT_URL: $ENVIRONMENT_URL/prometheus
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_deploy.yml'
    strategy: depend
  needs: [ ]
  rules:
    - when: manual

# METALLB ==============================================================================================================
metallb:
  stage: addons
  variables:
    RELEASE_NAME: metallb
    HELM_PATH: ops/Helm/addons/metallb
    HELM_NAMESPACE: metallb-system
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_deploy.yml'
    strategy: depend
  needs: [ ]
  rules:
    - when: manual

# NGINX-INGRESS ========================================================================================================
nginx-ingress:
  stage: addons
  variables:
    RELEASE_NAME: nginx-ingress
    HELM_PATH: ops/Helm/addons/gateway/nginx-ingress
    HELM_NAMESPACE: nginx-ingress
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_deploy.yml'
    strategy: depend
  needs: []
  rules:
    - when: manual