# Deploy ===============================================================================================================
argo:
  stage: deploy
  variables:
    RELEASE_NAME: argocd
    HELM_PATH: ops/Helm/addons/argocd
    HELM_NAMESPACE: argocd
    ENVIRONMENT_URL: $ENVIRONMENT_URL/argocd
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_deploy.yml'
    strategy: depend
  needs: []
  rules:
    - when: manual

flux:
  stage: deploy
  variables:
    RELEASE_NAME: flux
    HELM_PATH: ops/Helm/addons/flux
    HELM_NAMESPACE: flux
    ENVIRONMENT_URL: $ENVIRONMENT_URL/flux
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_deploy.yml'
    strategy: depend
  needs: []
  rules:
    - when: manual

keda:
  stage: deploy
  variables:
    RELEASE_NAME: keda
    HELM_PATH: ops/Helm/addons/keda
    HELM_NAMESPACE: keda
    ENVIRONMENT_URL: $ENVIRONMENT_URL/keda
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_deploy.yml'
    strategy: depend
  needs: []
  rules:
    - when: manual

flagger:
  stage: deploy
  variables:
    RELEASE_NAME: flagger
    HELM_PATH: ops/Helm/addons/flagger
    HELM_NAMESPACE: ingress-nginx
    ENVIRONMENT_URL: $ENVIRONMENT_URL/flagger
  trigger:
    include:
      - local: 'ops/gitlab/pipelines/helm_deploy.yml'
    strategy: depend
  needs: []
  rules:
    - when: manual
