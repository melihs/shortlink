apiVersion: v1
kind: ConfigMap
metadata:
  name: shortlink-init-sql
data:
  init.sql: |
    -- enable extensions
    CREATE EXTENSION "uuid-ossp";
    CREATE EXTENSION pg_prewarm;
    ALTER SYSTEM SET shared_preload_libraries = 'pg_prewarm';
    
    -- link database
    CREATE SCHEMA link;
    GRANT ALL PRIVILEGES ON DATABASE link TO link;
    ALTER DATABASE link OWNER TO link;
     
    -- billing database
    CREATE SCHEMA billing;
    GRANT ALL PRIVILEGES ON DATABASE billing TO billing;
    ALTER DATABASE billing OWNER TO billing;
